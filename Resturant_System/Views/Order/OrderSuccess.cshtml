@model Order
@{
    ViewData["Title"] = "Order Success";
}

@{
    Layout = "_CustomerLayout";
}


<style>
    .confirmation-container {
        max-width: 800px;
        margin: 50px auto;
    }

    .success-icon {
        font-size: 5rem;
        color: #27ae60;
        animation: scaleIn 0.5s ease-in-out;
    }

    @@keyframes scaleIn {
        from {
            transform: scale(0);
            opacity: 0;
        }

        to {
            transform: scale(1);
            opacity: 1;
        }
    }

    .order-card {
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .order-header {
        background: linear-gradient(135deg, #e74c3c, #f39c12);
        color: white;
        padding: 30px;
        text-align: center;
    }

    .order-body {
        padding: 30px;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
    }

        .info-row:last-child {
            border-bottom: none;
        }
</style>

<div class="container confirmation-container">
    <div class="card order-card border-0">
        <!-- Header -->
        <div class="order-header">
            <div class="success-icon mb-3">
                <i class="bi bi-check-circle-fill"></i>
            </div>
            <h1 class="mb-2">Order Confirmed! 🎉</h1>
            <p class="mb-0">Thank you for your order!</p>
        </div>

        <!-- Body -->
        <div class="order-body">
            <!-- Order Number -->
            <div class="alert alert-success text-center mb-4">
                <h3 class="mb-1">Order #@Model.Id</h3>
                <h4 class="mb-0 text-danger">Total: @Model.TotalAmount.ToString("C")</h4>
            </div>

            <!-- Order Details -->
            <h5 class="mb-3">📋 Order Details</h5>
            <div class="mb-4">
                <div class="info-row">
                    <span>👤 Customer:</span>
                    <strong>@Model.Customer.Name</strong>
                </div>
                <div class="info-row">
                    <span>📞 Phone:</span>
                    <strong>@Model.Customer.PhoneNumber</strong>
                </div>
                <div class="info-row">
                    <span>📦 Order Type:</span>
                    <strong>@Model.PlacingOrder</strong>
                </div>
                <div class="info-row">
                    <span>💳 Payment Method:</span>
                    <strong>@Model.Payment?.PaymentMethod</strong>
                </div>
                @if (Model.TableNumber.HasValue)
                {
                    <div class="info-row">
                        <span>🪑 Table Number:</span>
                        <strong>@Model.TableNumber</strong>
                    </div>
                }
                @if (!string.IsNullOrEmpty(Model.DeliveryAddress))
                {
                    <div class="info-row">
                        <span>📍 Delivery Address:</span>
                        <strong>@Model.DeliveryAddress</strong>
                    </div>
                }
                <div class="info-row">
                    <span>📊 Status:</span>
                    <span class="badge bg-warning text-dark">@Model.OrderStatus</span>
                </div>
                <div class="info-row">
                    <span>📅 Order Date:</span>
                    <strong>@Model.CreatedAt.ToString("dd/MM/yyyy hh:mm tt")</strong>
                </div>
            </div>

            <!-- Items -->
            <h5 class="mb-3">🍽️ Order Items</h5>
            <div class="table-responsive mb-4">
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Item</th>
                            <th>Category</th>
                            <th class="text-center">Qty</th>
                            <th class="text-end">Price</th>
                            <th class="text-end">Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.OrderItems.Where(oi => !oi.IsDeleted))
                        {
                            <tr>
                                <td>@item.MenuItem.Name</td>
                                <td><span class="badge bg-secondary">@item.MenuItem.Category.Name</span></td>
                                <td class="text-center">@item.Quantity</td>
                                <td class="text-end">@item.UnitPrice.ToString("C")</td>
                                <td class="text-end"><strong>@item.Subtotal.ToString("C")</strong></td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>

            <!-- Price Breakdown -->
            <h5 class="mb-3">💰 Price Breakdown</h5>
            <div class="mb-4">
                <div class="info-row">
                    <span>Subtotal:</span>
                    <strong>@Model.Subtotal.ToString("C")</strong>
                </div>
                @if (Model.Discounts > 0)
                {
                    <div class="info-row">
                        <span>Discount:</span>
                        <strong class="text-success">- @Model.Discounts.ToString("C")</strong>
                    </div>
                }
                <div class="info-row">
                    <span>Tax (8.5%):</span>
                    <strong>@Model.Tax.ToString("C")</strong>
                </div>
                @if (Model.DeliveryFee > 0)
                {
                    <div class="info-row">
                        <span>Delivery Fee:</span>
                        <strong>@Model.DeliveryFee.ToString("C")</strong>
                    </div>
                }
                <div class="info-row">
                    <span class="fs-5"><strong>Total:</strong></span>
                    <strong class="text-danger fs-5">@Model.TotalAmount.ToString("C")</strong>
                </div>
            </div>

            <!-- Notes -->
            @if (!string.IsNullOrEmpty(Model.Notes))
            {
                <div class="alert alert-light">
                    <strong>📝 Notes:</strong> @Model.Notes
                </div>
            }

            <!-- Action Buttons -->
            <div class="d-flex gap-2 justify-content-center mt-4">
                <a asp-controller="GuestMenu" asp-action="Menu" class="btn btn-success btn-lg">
                    🍽️ Order More
                </a>
            </div>
        </div>
    </div>
</div>